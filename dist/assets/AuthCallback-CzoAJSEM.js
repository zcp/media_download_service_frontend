import{aC as d,aB as p,r as _,h as m,al as k,y as r,z as a,A as h,Q as g,K as v,O as f}from"./vue-CG64YRnT.js";import{u as y}from"./index-DUeX6V2y.js";import{_ as w}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./elementPlus-Djpklj9S.js";import"./utils-Dq7h7Pqt.js";const C={class:"auth-callback"},b={class:"loading-container"},x={class:"status-text"},A={key:0},S={key:1},T={key:2},B={__name:"AuthCallback",setup(q){const s=d(),n=p(),l=y(),o=_("processing"),u=_("");return m(async()=>{var c;console.log("AuthCallback页面加载，处理登录回调...");try{const t=s.query.token||((c=s.hash.match(/access_token=([^&]*)/))==null?void 0:c[1]);if(!t)throw new Error("未找到访问令牌");if(console.log("获取到Token，设置认证状态..."),!l.setToken(t))throw new Error("Token设置失败");o.value="success";const e=s.query.state||s.query.redirect_uri||localStorage.getItem("auth_redirect_path");console.log("登录成功，准备跳转到:",e),localStorage.removeItem("auth_redirect_path"),setTimeout(()=>{e&&e.startsWith("http")?window.location.href=e:e&&e.startsWith("/")?n.push(e):n.push("/download-center/tasks")},1e3)}catch(t){console.error("登录回调处理失败:",t),o.value="error",u.value=t.message,setTimeout(()=>{l.logout()},3e3)}}),(c,t)=>{const i=k("el-loading");return a(),r("div",C,[h("div",b,[g(i,{visible:!0,text:"登录处理中..."}),h("div",x,[o.value==="processing"?(a(),r("p",A,"正在处理登录信息...")):o.value==="success"?(a(),r("p",S,"登录成功，正在跳转...")):o.value==="error"?(a(),r("p",T,"登录失败："+f(u.value),1)):v("",!0)])])])}}},R=w(B,[["__scopeId","data-v-04af0043"]]);export{R as default};

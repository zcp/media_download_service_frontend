import{aC as L,aB as O,r as v,c as Q,h as q,al as p,ar as G,y as z,z as w,Q as a,I as o,A as t,u,M as r,O as i,J as W,H as X,K as T}from"./vue-CG64YRnT.js";import{a as Y}from"./index-DpMErgrC.js";import{b as Z,c as ee,f as C}from"./time-BU10aqh9.js";import{E as y,g as te,h as ae}from"./elementPlus-Djpklj9S.js";import{_ as le}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./utils-Dq7h7Pqt.js";const oe={class:"videos-page"},se={class:"page-header"},ie={class:"header-left"},ne={class:"page-title"},de={class:"header-right"},re={class:"path-item"},ue={class:"pagination-area"},pe={key:0,class:"video-detail"},_e={class:"detail-grid"},ce={class:"detail-item"},me={class:"detail-item"},ve={class:"detail-item"},ge={class:"detail-item"},fe={class:"path-detail"},he={key:0,class:"detail-item"},we={class:"detail-item"},ye={class:"detail-item"},be={__name:"DownloadVideosDetail",setup(ke){const S=L(),I=O(),g=Y(),_=v(!1),c=v(1),f=v(20),b=v(!1),n=v(null),V=Q(()=>S.params.taskId);q(async()=>{await h()});const h=async()=>{_.value=!0;try{await g.fetchVideos(V.value,{page:c.value,size:f.value})}catch{y.error("获取视频列表失败")}finally{_.value=!1}},B=async()=>{await h(),y.success("刷新成功")},M=async s=>{f.value=s,c.value=1,await h()},U=async s=>{c.value=s,await h()},N=s=>{n.value=s,b.value=!0},D=async s=>{try{await navigator.clipboard.writeText(s),y.success("路径已复制到剪贴板")}catch{y.error("复制失败")}},R=()=>I.back(),$=s=>({hls:"primary",mp4:"success",image:"warning"})[s]||"",E=s=>({completed:"已完成",partial_completed:"部分完成",failed:"失败"})[s]||s,H=s=>({completed:"success",partial_completed:"warning",failed:"danger"})[s]||"";return(s,e)=>{const m=p("el-button"),k=p("el-tag"),x=p("el-card"),d=p("el-table-column"),P=p("el-table"),j=p("el-pagination"),A=p("el-link"),F=p("el-dialog"),J=G("loading");return w(),z("div",oe,[a(x,{class:"header-card",shadow:"never"},{default:o(()=>[t("div",se,[t("div",ie,[a(m,{onClick:R,icon:u(te),type:"text"},{default:o(()=>e[5]||(e[5]=[r("返回")])),_:1,__:[5]},8,["icon"]),t("h2",ne,"已下载视频列表（任务 "+i(V.value)+"）",1),a(k,{type:"info",size:"large"},{default:o(()=>[r(" 共 "+i(u(g).videosTotal)+" 个视频 ",1)]),_:1})]),t("div",de,[a(m,{onClick:B,loading:_.value},{default:o(()=>e[6]||(e[6]=[r("刷新")])),_:1,__:[6]},8,["loading"])])])]),_:1}),a(x,{class:"table-card",shadow:"never"},{default:o(()=>[W((w(),X(P,{data:u(g).videos,loading:_.value,border:"",stripe:"",height:"600"},{default:o(()=>[a(d,{prop:"id",label:"视频ID",width:"280","show-overflow-tooltip":""}),a(d,{prop:"video_id",label:"文件标识",width:"200","show-overflow-tooltip":""}),a(d,{prop:"liveroom_id",label:"直播间ID",width:"120"}),a(d,{prop:"resource_type",label:"类型",width:"100"},{default:o(({row:l})=>[a(k,{type:$(l.resource_type),size:"small"},{default:o(()=>[r(i(l.resource_type.toUpperCase()),1)]),_:2},1032,["type"])]),_:1}),a(d,{prop:"file_size",label:"文件大小",width:"120"},{default:o(({row:l})=>[r(i(u(Z)(l.file_size)),1)]),_:1}),a(d,{prop:"duration",label:"时长",width:"100"},{default:o(({row:l})=>[r(i(u(ee)(l.duration)),1)]),_:1}),a(d,{prop:"resolution",label:"分辨率",width:"120"}),a(d,{prop:"format",label:"格式",width:"80"}),a(d,{prop:"storage_path",label:"存储路径",width:"300","show-overflow-tooltip":""},{default:o(({row:l})=>[t("div",re,[t("span",null,i(l.storage_path),1),a(m,{size:"small",text:"",onClick:K=>D(l.storage_path),icon:u(ae)},null,8,["onClick","icon"])])]),_:1}),a(d,{prop:"status",label:"状态",width:"100"},{default:o(({row:l})=>[a(k,{type:H(l.status),size:"small"},{default:o(()=>[r(i(E(l.status)),1)]),_:2},1032,["type"])]),_:1}),a(d,{prop:"download_end_time",label:"完成时间",width:"160"},{default:o(({row:l})=>[r(i(u(C)(l.download_end_time,"MM-DD HH:mm")),1)]),_:1}),a(d,{label:"操作",width:"120",fixed:"right"},{default:o(({row:l})=>[a(m,{size:"small",type:"primary",onClick:K=>N(l)},{default:o(()=>e[7]||(e[7]=[r(" 详情 ")])),_:2,__:[7]},1032,["onClick"])]),_:1})]),_:1},8,["data","loading"])),[[J,_.value]]),t("div",ue,[a(j,{"current-page":c.value,"onUpdate:currentPage":e[0]||(e[0]=l=>c.value=l),"page-size":f.value,"onUpdate:pageSize":e[1]||(e[1]=l=>f.value=l),"page-sizes":[10,20,50,100],total:u(g).videosTotal,layout:"total, sizes, prev, pager, next, jumper",onSizeChange:M,onCurrentChange:U},null,8,["current-page","page-size","total"])])]),_:1}),a(F,{modelValue:b.value,"onUpdate:modelValue":e[3]||(e[3]=l=>b.value=l),title:"视频详情",width:"600px",onClose:e[4]||(e[4]=l=>n.value=null)},{default:o(()=>[n.value?(w(),z("div",pe,[t("div",_e,[t("div",ce,[e[8]||(e[8]=t("label",null,"视频ID:",-1)),t("span",null,i(n.value.video_id),1)]),t("div",me,[e[9]||(e[9]=t("label",null,"直播间标题:",-1)),t("span",null,i(n.value.liveroom_title||"-"),1)]),t("div",ve,[e[11]||(e[11]=t("label",null,"资源URL:",-1)),a(A,{href:n.value.resource_url,target:"_blank",type:"primary"},{default:o(()=>e[10]||(e[10]=[r(" 查看原始资源 ")])),_:1,__:[10]},8,["href"])]),t("div",ge,[e[13]||(e[13]=t("label",null,"存储路径:",-1)),t("div",fe,[t("span",null,i(n.value.storage_path),1),a(m,{size:"small",onClick:e[2]||(e[2]=l=>D(n.value.storage_path))},{default:o(()=>e[12]||(e[12]=[r(" 复制路径 ")])),_:1,__:[12]})])]),n.value.cover_path?(w(),z("div",he,[e[14]||(e[14]=t("label",null,"封面路径:",-1)),t("span",null,i(n.value.cover_path),1)])):T("",!0),t("div",we,[e[15]||(e[15]=t("label",null,"下载开始时间:",-1)),t("span",null,i(u(C)(n.value.download_start_time)),1)]),t("div",ye,[e[16]||(e[16]=t("label",null,"下载结束时间:",-1)),t("span",null,i(u(C)(n.value.download_end_time)),1)])])])):T("",!0)]),_:1},8,["modelValue"])])}}},Se=le(be,[["__scopeId","data-v-414dec44"]]);export{Se as default};

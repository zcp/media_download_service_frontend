---

# 媒体下载服务前端设计文件 (最终版)

## 一、设计目标

- 构建一个直观、易用的用户界面，使用户能够高效地管理媒体下载任务。
- 实现与后端API的无缝集成，支持下载任务的全生命周期管理（创建、查询、更新、删除、重试）。
- 提供下载任务的实时状态和进度反馈。
- 遵循统一的UI/UX规范，确保良好的用户体验。
- 实现前端的数据验证和错误处理。
- 界面设计参考哔哩哔哩风格，并针对医生和医生从业者的专业视频网站场景进行优化。
- **性能目标:** 确保任务列表页在数据量较大时仍能快速加载和流畅滚动；详情页数据实时更新延迟低。
- **可维护性目标:** 代码结构清晰，模块化程度高，易于理解和修改。
- **安全性目标:** 防范常见的Web安全漏洞（如XSS），确保用户数据安全。
- **可扩展性目标:** 设计灵活，易于未来新增功能或调整界面。

## 二、技术选型 (待定)

- **前端框架:** Vue
- **状态管理:** Vuex
- **UI组件库:** Element UI 
- **API请求库:** Axios / Fetch API
- **路由管理:** Vue Router
- **实时通信:** WebSocket 
- **构建工具:** Webpack 
- **代码规范:** ESLint 
- **测试框架:** Vue Test Utils (单元测试、组件测试)
{{ edit_1 }}
- **日期处理库:** Moment.js / Day.js (用于时间戳的格式化和时区处理)

## 三、数据模型/接口定义

根据后端 <mcfile name="媒体下载服务设计文档v2.md" path="d:\python_code\user_login\媒体下载服务设计文档v2.md"></mcfile> 中数据库表定义，前端需要定义相应的数据模型来处理从后端接收的数据。这些模型字段将与数据库表字段保持一致。

### 3.1. 下载任务模型 (`DownloadTask`)

- `id`: string (UUID)
- `video_id`: string (VARCHAR)
- `liveroom_id`: string (VARCHAR)
- `liveroom_title`: string | null (VARCHAR)
- `liveroom_url`: string | null (VARCHAR)
- `resource_url`: string (VARCHAR)
- `resource_type`: string (VARCHAR, 'hls', 'mp4', 'image')
- `status`: string (VARCHAR, 'pending', 'processing', 'completed', 'partial_completed', 'failed', 'cancelled')
- `progress`: number (FLOAT, 0-1)
- `retry_count`: number (INT)
- `last_error`: string | null (TEXT)
- `created_at`: string (TIMESTAMP, ISO 8601格式)
- `updated_at`: string (TIMESTAMP, ISO 8601格式)
- `completed_at`: string | null (TIMESTAMP, ISO 8601格式)

### 3.2. 下载失败记录模型 (`DownloadFailure`)

- `id`: string (UUID)
- `task_id`: string (UUID)
- `resource_url`: string (TEXT)
- `expected_path`: string (TEXT)
- `resource_type`: string (VARCHAR, 'ts', 'mp4', 'image')
- `failure_type`: string (VARCHAR, 'network_error', 'timeout', 'invalid_content', 'storage_error', 'permission_error')
- `error_message`: string (TEXT)
- `retry_count`: number (INT)
- `next_retry_time`: string | null (TIMESTAMP, ISO 8601格式)
- `status`: string (VARCHAR, 'pending', 'retrying', 'abandoned')
- `created_at`: string (TIMESTAMP, ISO 8601格式)
- `updated_at`: string (TIMESTAMP, ISO 8601格式)

### 3.3. 单任务下已下载视频模型 (`DownloadedVideo`)

- `id`: string (UUID)
- `video_id`: string (VARCHAR)
- `liveroom_id`: string (VARCHAR)
- `liveroom_title`: string | null (VARCHAR)
- `liveroom_url`: string | null (VARCHAR)
- `resource_type`: string (VARCHAR, 'hls', 'mp4')
- `resource_url`: string (VARCHAR)
- `storage_path`: string (VARCHAR)
- `file_size`: number | null (BIGINT)
- `duration`: number | null (INT)
- `resolution`: string | null (VARCHAR)
- `format`: string | null (VARCHAR)
- `cover_url`: string | null (VARCHAR)
- `cover_path`: string | null (VARCHAR)
- `download_task_id`: string | null (UUID)
- `status`: string (VARCHAR, 'completed', 'partial_completed', 'failed')
- `download_start_time`: string | null (TIMESTAMP, ISO 8601格式)
- `download_end_time`: string | null (TIMESTAMP, ISO 8601格式)
- `created_at`: string (TIMESTAMP, ISO 8601格式)
- `updated_at`: string (TIMESTAMP, ISO 8601格式)

### 3.4. API统一响应格式

```typescript
interface ApiResponse<T> {
  code: number; // 状态码，200表示成功，其他表示错误
  message: string; // 响应消息
  data: T | null; // 实际返回内容，根据具体接口返回的数据模型而定
  timestamp: string; // 响应时间戳 (ISO 8601 格式)
}
```
### 3.5. API 接口列表 (已根据后端实际实现调整)

- GET /api/v1/download/tasks : 获取下载任务列表 (支持分页、排序、筛选)
- POST /api/v1/download/tasks : 创建新的下载任务
- GET /api/v1/download/tasks/{task_id} : 获取单个下载任务详情
- DELETE /api/v1/download/tasks/{task_id} : 取消/删除下载任务
- POST /api/v1/download/tasks/{task_id}/start : 开始下载任务
- POST /api/v1/download/tasks/{task_id}/retry : 重试下载任务
- GET /api/v1/download/tasks/{task_id}/failures : 获取任务的失败记录列表 (支持分页、排序)
- POST /api/v1/download/tasks/{task_id}/failures : 创建失败记录
- POST /api/v1/download/tasks/{task_id}/failures/{failure_id}/retry : 重试单个失败资源
- POST /api/v1/download/tasks/{task_id}/failures/{failure_id}/abandon : 放弃单个失败资源
- POST /api/v1/download/tasks/{task_id}/videos : 创建已下载视频记录
- GET /api/v1/download/tasks/{task_id}/videos : 获取单任务下的已下载视频列表

> **注意：全局已下载视频相关接口（如 GET /api/v1/downloaded-videos 等）后端未实现，前端不应设计相关页面和功能。**

## 四、界面设计与路由规划
### 4.1. 路由规划
- /download-center : 下载中心主页 (包含左侧导航菜单和右侧内容区域)
  - /download-center/tasks : 下载任务列表页 (嵌套在下载中心内)
  - /download-center/tasks/create : 创建下载任务页 (嵌套在下载中心内)
  - /download-center/tasks/:taskId : 下载任务详情页 (嵌套在下载中心内)
  - /download-center/tasks/:taskId/failures : 下载失败记录列表页 (嵌套在下载中心内)
  - /download-center/tasks/:taskId/videos : 单任务下已下载视频列表页 (嵌套在下载中心内)

> **注意：已删除"全局已下载视频列表页"和"全局已下载视频详情页"相关路由。**

### 4.2. 下载中心页面 (/download-center)
- 布局:
  - 页面整体分为左侧导航和右侧内容区域的两栏布局
  - 左侧导航菜单：提供各个下载功能模块的入口，包括下载任务列表、创建下载任务等
  - 右侧内容区域：根据左侧选择的菜单项，显示对应的功能页面内容
  - 整体风格保持与系统其他页面一致，特别是参考Bilibili风格进行设计

- 左侧导航菜单:
  - 菜单项：
    - "下载任务列表"：跳转到 /download-center/tasks
    - "创建下载任务"：跳转到 /download-center/tasks/create
    - "下载失败记录"：跳转到 /download-center/tasks/:taskId/failures
    - "单任务已下载视频"：跳转到 /download-center/tasks/:taskId/videos
  - 菜单项样式：当前选中的菜单项有高亮效果，鼠标悬停时有交互反馈
  - 每个菜单项配有对应的图标，增强视觉识别度

- 右侧内容区域:
  - 通过 Vue Router 的 <router-view> 组件动态加载对应的子组件
  - 内容区域有适当的内边距，确保内容不会贴近边缘
  - 内容区域可以独立滚动，左侧导航固定

- 响应式考虑:
  - 在较小屏幕上，可以考虑将左侧导航变为可折叠的侧边栏或顶部导航菜单

### 4.3. 下载任务列表页 (/download-center/tasks)
- 布局:
  - 页面采用左右分栏结构，左侧为导航菜单，右侧为内容区。
  - 内容区顶部为操作区（标题+按钮），下方为表格区，底部为分页区。
  - 参考 Bilibili 的简洁、专业风格，配色以蓝、灰、白为主，强调医疗行业的专业感和信息密度。
- 卡片式分区:
  - 操作区和表格区分别用 Element Plus 的 <el-card> 包裹，增加圆角和阴影，提升层次感。
  - 操作按钮右对齐，标题左对齐，按钮风格主色调突出。
- 数据表格/列表项:
  - 使用 <el-table>，开启 border 和 stripe，提升可读性。
  - 表格高度固定，内容超出时内部滚动，避免页面整体滚动。
  - 表格内容左对齐，重要字段（如状态、进度）居中或用颜色/图标突出。
  - 鼠标悬停高亮行，点击行可查看详情
  - 核心信息: 任务ID ( id )、视频ID ( video_id )、直播间ID ( liveroom_id )、资源类型 ( resource_type )、状态 ( status )、进度 ( progress ，前端展示时转换为0-100%)、重试次数 ( retry_count )、创建时间 ( created_at )、更新时间 ( updated_at )。
  - 操作列:
    - "详情": 跳转到任务详情页 ( /download-center/tasks/:taskId )。
    - "重试": 调用 POST /api/v1/download/tasks/{task_id}/retry API。仅在 failed 状态下可用。
    - "取消": 调用 DELETE /api/v1/download/tasks/{task_id} API。仅在 pending , processing 状态下可用。操作前应有确认提示。
    - "失败记录": 跳转到失败记录列表页 ( /download-center/tasks/:taskId/failures )。仅在 failed 或 partial_completed 状态下可用。
    - "单任务已下载视频": 跳转到 /download-center/tasks/:taskId/videos
  - 状态显示: 使用不同颜色、图标或标签清晰表示不同的任务状态 ( pending , processing , completed , partial_completed , failed , cancelled )。例如，绿色表示完成，红色表示失败，蓝色表示进行中。
  - 进度显示: 使用简洁的进度条组件展示 progress 字段的值（0-1），并转换为百分比显示。进度条颜色可随状态变化。
- 筛选与排序:
  - 在列表上方或侧边提供筛选区域，允许按状态 ( status )、资源类型 ( resource_type )、直播间ID ( liveroom_id ) 等进行筛选。
  - 表格头部提供按创建时间 ( created_at )、更新时间 ( updated_at )、状态 ( status ) 等字段进行排序的功能。
- 数据刷新: 实现定时轮询 ( GET /api/v1/download/tasks ) 获取最新任务列表数据，更新界面状态和进度。轮询间隔可根据任务状态智能调整。如果后端支持，优先使用WebSocket进行实时推送。
- 性能考虑: 对于大量任务，考虑使用虚拟列表（Virtual Scrolling）技术，只渲染可视区域内的列表项，提高页面性能。
- 表格字段与交互
  - 字段展示
    - 任务ID、视频ID等长字段中间省略（如 xxxx...xxxx），悬停显示完整内容。
    - 状态字段用彩色标签（<el-tag>），进度用进度条（<el-progress>），提升视觉识别度。
    - 操作列按钮分组，间距适中，避免拥挤。
  - 操作按钮
    - 详情、重试、删除、失败记录等操作按钮分组显示，主次分明。
    - 重要操作（如删除）需二次确认，防止误操作。
 -  空状态与加载
  - 无数据时显示友好提示，引导用户创建新任务。
  - 数据加载时显示 loading 动画，防止误操作。

### 4.4. 创建下载任务页 (/download-center/tasks/create)
- 布局:
  - 页面顶部：标题 "创建下载任务"。
  - 页面主体：结构化的表单区域。表单项应分组清晰，例如"基本信息"、"下载参数"等。
  - 参考Bilibili: 可以借鉴其投稿页面的表单布局和交互方式，确保用户输入流畅。
- 表单项:
  - 资源URL ( resource_url ): 文本输入框，必填。提供输入提示或格式要求说明。
  - 资源类型 ( resource_type ): 下拉选择框，选项包括 'hls', 'mp4', 'image'，必填。
  - 视频ID ( video_id ): 文本输入框，必填，需要符合 {liveroom_id}_{uuid4后缀} 格式。提供格式说明或输入校验提示。
  - 直播间ID ( liveroom_id ): 文本输入框，必填。
  - 直播间标题 ( liveroom_title ): 文本输入框，可选。
  - 直播间URL ( liveroom_url ): 文本输入框，可选。
  - 其他可能的参数 (根据后端创建任务API定义补充，如清晰度选择等)。
- 表单验证:
  - 对必填项进行前端验证，并实时显示验证错误信息。
  - 对URL格式进行基本验证。
  - 对 video_id 格式进行正则验证。
- 提交操作:
  - "创建" 按钮：调用 POST /api/v1/download/tasks API。按钮应在提交过程中显示加载状态并禁用。
  - "取消" 按钮：返回任务列表页。
  - 提交成功后，显示成功提示，并跳转回任务列表页或新创建的任务详情页。
  - 提交失败时，显示错误提示（使用消息提示组件），并高亮出错的表单项。
- 用户引导: 对于 video_id 格式要求，可以提供一个示例或生成器，帮助用户输入正确的格式。
- 智能识别: 考虑是否可以根据输入的 resource_url 尝试自动识别 video_id , liveroom_id , liveroom_title , liveroom_url 等信息，减少用户输入负担。这需要后端或第三方库支持。
- 重复提交: 提交按钮在点击后应立即禁用，防止用户重复提交。

### 4.5. 下载任务详情页 (/download-center/tasks/:taskId)
- 布局:
  - 页面顶部：标题区域，显示 "任务详情" 和任务ID。
  - 页面主体：核心区域展示任务详细信息。可以采用分块或Tab页的方式组织信息。
  - 参考Bilibili: 可以借鉴其视频详情页的布局，将核心信息（状态、进度）放在显眼位置，其他信息（元数据、失败记录）放在下方或侧边区域，或通过Tab切换。
- 信息展示:
  - 基本信息块: 显示 DownloadTask 模型中的所有字段：ID ( id )、视频ID ( video_id )、直播间ID ( liveroom_id )、直播间标题 ( liveroom_title )、直播间URL ( liveroom_url )、原始URL ( resource_url )、资源类型 ( resource_type )、状态 ( status )、进度 ( progress )、重试次数 ( retry_count )、最后错误 ( last_error )、创建时间 ( created_at )、更新时间 ( updated_at )、完成时间 ( completed_at )。
  - 状态和进度应实时更新（通过轮询 GET /api/v1/download/tasks/{task_id} 或 WebSocket）。进度条和状态显示应与列表页保持一致。
  - last_error 字段在有错误时才显示，并可能需要展开/收起功能以避免占用过多空间。
- 操作按钮区域:
  - 与列表页的操作按钮类似 (重试、取消)，根据当前任务状态动态显示/隐藏。按钮应醒目且易于点击。
  - "查看失败记录" 按钮：跳转到失败记录列表页 ( /download-center/tasks/:taskId/failures )。仅在 failed 或 partial_completed 状态下可用。
  - "单任务已下载视频" 按钮：跳转到 /download-center/tasks/:taskId/videos
- 失败记录 Tab/区域:
  - 如果采用Tab页布局，一个Tab用于展示基本信息，另一个Tab用于展示该任务关联的失败记录列表。
- 实时更新机制: 明确是采用定时轮询还是WebSocket。如果使用轮询，需要考虑轮询频率的动态调整，例如任务处于 processing 状态时频率高，其他状态频率低或停止轮询。如果使用WebSocket，需要处理连接断开和重连。
- 状态变化处理: 当任务状态发生变化时（例如从 processing 到 completed 或 failed ），界面应有明显的视觉反馈，并可能需要自动停止实时更新。
- 关联信息: 如果 download_task_id 在 DownloadedVideo 中有值，在任务详情页是否需要链接到关联的已下载视频详情页？（现仅支持单任务下视频列表）

### 4.6. 下载失败记录列表页 (/download-center/tasks/:taskId/failures)
- 布局:
  - 页面顶部：标题区域，显示 "任务 [任务ID] 的失败记录"。提供返回任务详情页的导航。
  - 页面主体：数据表格，展示失败记录列表。
  - 页面底部：分页控件。
- 数据表格:
  - 列: 失败ID ( id )、资源URL ( resource_url )、期望路径 ( expected_path )、资源类型 ( resource_type )、失败类型 ( failure_type )、错误信息 ( error_message )、重试次数 ( retry_count )、下次重试时间 ( next_retry_time )、状态 ( status )、创建时间 ( created_at )、更新时间 ( updated_at )、操作。
  - 操作列:
    - "重试": 调用 POST /api/v1/download/tasks/{task_id}/failures/{failure_id}/retry API。
    - "放弃": 调用 POST /api/v1/download/tasks/{task_id}/failures/{failure_id}/abandon API。操作前应有确认提示。
  - 错误信息显示: error_message 字段可能较长，可以考虑截断显示，提供查看完整信息的选项（如Tooltip或Modal）。
- 分页与排序:
  - 实现基于后端API ( GET /api/v1/download/tasks/{task_id}/failures ) 的分页和排序功能。
- 错误信息可读性: error_message 可能包含技术细节，考虑是否需要对用户友好的错误描述进行映射或处理。
- 重试/放弃操作反馈: 用户点击重试或放弃后，该条失败记录的状态应立即更新，并给出操作结果提示。

### 4.7. 单任务下已下载视频列表页 (/download-center/tasks/:taskId/videos)
- 布局:
  - 页面顶部：标题 "已下载视频列表（当前任务）"。
  - 页面主体：数据表格或卡片列表，展示当前任务下的已下载视频列表。
  - 页面底部：分页控件。
- 数据表格/卡片项:
  - 核心信息: ID ( id )、视频ID ( video_id )、直播间ID ( liveroom_id )、资源类型 ( resource_type )、存储路径 ( storage_path )、文件大小 ( file_size )、分辨率 ( resolution )、格式 ( format )、时长 ( duration )、完成时间 ( download_end_time )。
  - 封面图: 如果 cover_url 或 cover_path 字段有值，在卡片中展示封面图。
  - 操作列/按钮:
    - "详情": 可扩展为弹窗或新页面展示视频详情。
- 分页与排序:
  - 实现基于后端API的分页和排序功能。
- 筛选与搜索:
  - 提供按视频ID、直播间ID、资源类型等进行筛选和搜索的功能。
- 文件大小/时长格式化: file_size (BIGINT) 需要转换为用户友好的单位（KB, MB, GB）。 duration (INT, 秒) 需要转换为时分秒格式。
- 封面图加载失败: 如果封面图URL无效或加载失败，需要显示一个默认占位图。

> **注意：已删除"全局已下载视频列表页"和"全局已下载视频详情页"相关内容。**

## 五、功能实现细节
### 5.1. API交互
- 封装API请求函数，统一处理请求头、错误处理和响应格式解析。
- 使用异步请求 ( async/await )。
- 在请求发送时显示加载状态，请求完成后隐藏。
- 根据后端统一响应格式（ `媒体下载服务设计文档v2.md` 5.1.1），判断请求是否成功 ( code == 200 )，成功则处理 data ，失败则提取 message 和 code 进行错误提示。
- 处理分页请求参数 ( page , size , sort ) 和解析分页响应 ( total , page , size , items )。
- 请求取消: 在组件卸载或用户切换页面时，应取消正在进行的API请求，避免内存泄漏和不必要的资源消耗。
- 错误码处理: 除了通用的错误提示，是否需要针对特定的后端错误码进行特殊处理或更详细的提示？
- 认证/授权: 如何处理用户认证（如Token）和API请求的授权？这部分通常是前端框架或全局API封装层需要考虑的。
  {{ edit_2 }}
- API 版本控制: 考虑API版本变化时的兼容性处理。
- 请求重试机制: 对于网络不稳定等情况，是否需要在前端实现请求的自动重试？
### 5.2. 状态管理
- 在全局状态中存储下载任务列表、单个任务详情、失败记录列表、已下载视频列表等。
- 当从后端获取到新的数据时，更新状态。
- 对于列表页，实现分页和排序的状态管理。
- 对于任务详情页，实现定时刷新逻辑，更新任务状态和进度。
- 状态结构设计: 状态树的设计应考虑模块化和可扩展性，避免状态过于扁平或耦合。
- 数据同步: 如何确保不同页面或组件之间的数据同步？例如，在详情页更新了任务状态，列表页如何反映这个变化？（WebSocket或全局事件总线可能是解决方案）。
- 缓存策略: 是否需要对某些不经常变化的数据进行缓存，减少API请求？
  {{ edit_3 }}
- Loading/Error 状态管理: 除了数据本身，状态管理还需要包含数据加载状态 ( loading: boolean ) 和错误状态 ( error: any )，以便在UI中正确展示加载中或错误信息。
- 数据范式化: 如果数据之间存在复杂关联（如任务与失败记录），考虑使用范式化存储数据，避免数据冗余和不一致。
### 5.3. 实时进度更新
- 任务列表和详情页需要实时显示下载进度。
- 可以采用定时轮询后端API ( GET /api/v1/download/tasks 或 GET /api/v1/download/tasks/{task_id} ) 的方式获取最新进度。轮询间隔可以根据任务状态调整（例如， processing 状态下轮询更频繁）。
- 更优的方案是后端支持WebSocket或Server-Sent Events，前端建立连接并监听任务状态和进度更新事件。
- WebSocket/SSE 实现细节: 如果采用WebSocket/SSE，需要详细设计前端的连接管理（连接、断开、重连）、消息接收和处理逻辑。如何将接收到的消息更新到对应的任务状态？
- 轮询优化: 如果使用轮询，除了动态调整频率，还可以考虑长轮询（Long Polling）或只在用户当前查看的页面进行轮询。
  {{ edit_4 }}
- 心跳机制: 如果使用WebSocket，需要实现心跳机制来检测连接是否仍然有效，并处理断开重连。
- 消息格式: 明确WebSocket/SSE推送的消息格式，包含哪些字段（如任务ID、最新状态、进度等）。
- 权限控制: 确保用户只能接收到自己有权限的任务的更新。
### 5.4. 错误处理与提示
- 捕获API请求失败（网络错误、超时等）和后端返回的业务错误 ( code != 200 )。
- 使用UI组件库提供的消息提示组件（如Toast、Notification）向用户显示错误信息 ( response.message )。
- 在表单提交失败时，在表单下方或相关字段旁显示错误提示。
- 对于下载失败的任务或失败记录，在详情页或失败记录列表中清晰展示 failure_type 和 error_message 。
- 全局错误捕获: 实现一个全局的错误处理机制，捕获未预料的JavaScript错误或API错误，并进行上报（如果需要）。
- 用户反馈: 错误提示应清晰、简洁，避免技术术语。对于可操作的错误（如网络断开），提供重试按钮。
- 日志记录: 在前端记录关键的错误信息，方便调试和问题排查。
  {{ edit_5 }}
- 错误分类: 将错误分为网络错误、业务错误、前端运行时错误等，针对不同类型错误采用不同的处理和提示方式。
- 用户操作回滚: 对于某些操作（如取消任务），如果后端返回失败，前端需要将状态回滚到操作前的状态。
### 5.5. 路径处理 (前端展示)

- 后端负责跨平台路径生成和处理。前端仅负责展示后端返回的 storage_path 和 cover_path 。
- 路径复制功能: 考虑为 `storage_path` 提供一键复制到剪贴板的功能，方便用户在本地文件管理器中打开。

### 5.6. 时间戳处理

- 后端返回的时间戳是ISO 8601格式。前端需要将其转换为用户友好的本地时间格式进行展示。
{{ edit_1 }}
- **时区考虑:** 转换时间时，需要考虑用户所在的时区。通常使用JavaScript的 `Date` 对象或日期处理库（如 `moment.js`, `dayjs`）进行转换。
- **格式化选项:** 提供不同的时间格式选项，例如"刚刚"、"X分钟前"、"今天 HH:mm"、"YYYY-MM-DD HH:mm"等，增强用户体验。对于专业用户，精确到秒的格式（YYYY-MM-DD HH:mm:ss）可能更重要。
- **日期库选择:** 推荐使用 Day.js，它比 Moment.js 更轻量，且API相似。

### 5.7. 数据验证

- 在创建任务表单提交前，进行前端数据验证，包括必填项、URL格式、 video_id 格式等，减少无效请求。
- 后端验证: 强调前端验证是辅助性的，后端必须进行严格的数据验证，前端不应完全依赖前端验证。
- 实时验证: 输入框失焦或内容变化时进行实时验证，及时给用户反馈。
- 复杂验证规则: 对于 `video_id` 格式等复杂规则，使用正则表达式或专门的验证库。
{{ edit_2 }}
- **验证规则定义:** 明确列出每个需要验证的字段及其验证规则（如 `resource_url` 必须是有效的URL，`video_id` 必须匹配 `{liveroom_id}_{uuid4后缀}` 的正则等）。
- **用户友好提示:** 验证失败时的错误提示信息应清晰、具体，指导用户如何修正输入。

### 5.9. 用户主页与下载中心的集成

- 用户主页导航栏中添加"下载中心"按钮，点击后跳转到下载中心页面 (`/download-center`)。
- 按钮设计:
  - 使用橙色背景使按钮突出，增加可见性
  - 配有下载图标，提高识别度
  - 放置在导航栏右侧，与其他功能按钮并排，位置合理
- 跳转逻辑:
  - 点击按钮执行 `goToDownloadPage()` 方法
  - 该方法通过 Vue Router 导航到 `/download-center` 路径
  - 默认显示下载任务列表页面 (`/download-center/tasks`)
- 用户体验考虑:
  - 按钮点击后有明显的视觉反馈
  - 跳转流畅，保持一致的界面风格
  - 在下载中心可以通过左侧菜单轻松切换不同功能

## 六、用户体验优化

- 加载指示: 在进行API请求时，显示加载动画或禁用相关按钮，防止用户重复操作。
- 空状态: 当任务列表、失败记录列表或已下载视频列表为空时，显示友好的提示信息。
- 操作反馈: 用户执行暂停、恢复、取消、重试等操作后，及时更新界面状态，并给出操作成功的提示。
- 响应式设计: 考虑不同屏幕尺寸的设备，确保界面在桌面和移动端都能正常显示和使用。
- 可访问性: 遵循Web可访问性标准，确保所有用户都能方便地使用应用。
- 国际化 (i18n): 如果应用需要支持多种语言，考虑实现国际化。
{{ edit_3 }}
- **键盘导航:** 确保用户可以使用键盘进行导航和操作，特别是对于专业用户，键盘操作效率可能更高。
- **快捷键:** 考虑为常用操作（如创建任务、刷新列表）设置快捷键。
- **通知系统:** 对于任务状态变化（如完成、失败），考虑使用浏览器通知或应用内通知进行提醒。
- **用户偏好设置:** 未来可以考虑增加用户偏好设置，如列表每页显示数量、时间格式等。
- **性能感知:** 优化前端渲染性能，减少不必要的重绘和回流。对于长列表，使用虚拟滚动。

## 七、UI/UX 设计规范 (参考Bilibili并专业化)

- 整体风格: 简洁、专业、信息密度适中。避免过多花哨的动画和装饰。
- 色调: 采用偏冷色调或中性色调为主，如蓝色、灰色、白色。使用少量强调色（如绿色表示成功，红色表示失败，黄色表示警告）来突出状态信息。参考医疗或科技类网站的常用配色。
- 布局:
  - 顶部导航/侧边导航: 提供清晰的导航结构，方便用户在不同页面（任务列表、已下载视频等）之间切换。
  - 内容区域: 采用栅格系统布局，确保在不同分辨率下内容都能良好展示。列表页可采用表格或卡片布局，详情页采用分块布局。
  - 信息层级: 使用不同的字体大小、粗细和颜色来区分标题、正文、辅助信息等，确保信息易于扫描和理解。
- 组件:
  - 表格/列表: 列头清晰，数据对齐。重要状态信息使用标签或图标。操作按钮分组或使用下拉菜单。
  - 进度条: 简洁明了，实时更新。颜色随状态变化（如进行中蓝色，完成绿色，失败红色）。
  - 表单: 标签与输入框对齐，必填项有明确标记。输入验证提示友好且及时。
  - 按钮: 主要操作按钮醒目，次要操作按钮样式区分。禁用状态清晰可见。操作前需要确认的，使用Modal或Popconfirm。
  - 图标: 使用简洁、易于理解的图标，辅助文字说明。
- 字体: 选择易于阅读的无衬线字体，如 Arial, Helvetica, 或常用的中文字体（如思源黑体）。
- 交互反馈:
  - 加载状态: 按钮点击后显示加载中，列表/详情页数据加载时显示Loading Spinner。
  - 操作结果: 使用全局消息提示（Toast/Notification）反馈操作成功或失败。
  - 鼠标悬停: 列表项、按钮等可交互元素在鼠标悬停时有视觉反馈。
- 错误提示: 错误信息应具体、友好，并提供可能的解决方案（如重试）。表单验证错误应在对应输入框下方实时显示。
- 数据可视化: 考虑使用简单的图表（如果需要）来展示下载趋势或统计信息，但保持专业性。
{{ edit_4 }}
- **专业性体现:** 在UI细节上，避免过于娱乐化的元素。例如，图标设计应偏向扁平、线条简洁风格；配色应稳重；文字描述应准确、专业。
- **信息密度:** 考虑到医生用户可能需要快速浏览大量信息，列表页的信息密度可以适当提高，但要保证可读性。关键信息（如状态、进度、错误）应突出显示。
- **操作流程:** 简化创建任务、管理任务的操作流程，减少不必要的步骤。
- **帮助与文档:** 在界面中提供必要的帮助信息或链接到详细的使用文档，特别是对于复杂的字段（如 `video_id` 格式）或操作。

## 八、测试策略 (新增)

为了确保前端应用的质量和稳定性，需要制定详细的测试策略。

- **单元测试:** 对核心的工具函数、API服务封装、状态管理模块、Vuex/Pinia Actions/Mutations/Getters 等进行单元测试，确保其逻辑正确性。
- **组件测试:** 对独立的UI组件进行测试，验证其渲染、交互和props/events是否符合预期。
- **页面测试:** 对关键页面（如任务列表页、创建任务页）进行集成测试，模拟用户操作流程，验证页面功能和数据流是否正常。
- **端到端测试 (E2E):** 使用 Cypress 或 Playwright 等工具，模拟真实用户在浏览器中的完整操作路径，测试整个应用的流程，包括登录（如果需要）、创建任务、查看列表、操作任务等。
- **性能测试:** 测试页面加载时间、列表渲染性能、实时更新的延迟等，确保满足性能目标。
- **兼容性测试:** 在不同的浏览器和设备上测试应用，确保兼容性。
- **可访问性测试:** 使用工具或手动检查，确保应用符合可访问性标准。

## 九、部署与维护考虑 (新增)

- **构建流程:** 定义清晰的前端构建流程，包括代码检查、单元测试、打包、压缩、版本控制等。
- **部署方式:** 考虑应用的部署方式（如静态文件托管、Docker容器等），以及如何与后端服务集成。
- **日志与监控:** 集成前端错误日志收集和性能监控工具，及时发现和解决线上问题。
- **版本管理:** 采用语义化版本控制，方便管理和回滚。
- **持续集成/持续部署 (CI/CD):** 建立CI/CD流水线，自动化测试和部署过程，提高开发效率和部署质量。

## 十、安全性考虑 (新增)

- **XSS 防范:** 对用户输入和后端返回的数据进行严格的过滤和转义，防止跨站脚本攻击。
- **CSRF 防范:** 在关键的写操作API请求中，使用CSRF Token或其他机制进行防护。
- **认证与授权:** 确保只有经过认证和授权的用户才能访问和操作数据。前端需要正确处理Token的存储、传递和刷新。
- **敏感信息处理:** 避免在前端代码或日志中存储和传输敏感信息。
- **依赖安全:** 定期检查和更新项目依赖，避免使用存在已知安全漏洞的库。
- **HTTPS:** 强制使用HTTPS协议，保证数据传输安全。

---